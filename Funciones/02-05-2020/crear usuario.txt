create or replace FUNCTION INSERTPERSONA 
(
  FIRST_NAME IN VARCHAR2 
, SECOND_NAME IN VARCHAR2 
, LAST_NAME IN VARCHAR2 
, SECOND_LASTNAME IN VARCHAR2 
, AGE IN NUMBER 
, GENDER IN CHAR 
, CELL_PHONE IN NUMBER 
, ID_ADDRESS IN NUMBER 

) RETURN NUMBER 
AS 
    l_id_persona NUMBER;
BEGIN
    INSERT INTO PERSONA(PRIMER_NOMBRE, SEGUNDO_NOMBRE, PRIMER_APELLIDO, SEGUNDO_APELLIDO, EDAD, GENERO, TELEFONO_PERSONA, ID_DIRECCION_PERSONA) 
    VALUES(FIRST_NAME, SECOND_NAME, LAST_NAME, SECOND_LASTNAME, AGE, GENDER, CELL_PHONE, ID_ADDRESS)
    RETURNING ID_PERSONA INTO l_id_persona;
    RETURN l_id_persona;
END INSERTPERSONA;
--------------------------------
create or replace FUNCTION INSERTDIRECCION 
(
  DIRECCION IN VARCHAR2 
, ID_MUNICIPIO IN NUMBER 
) RETURN NUMBER 
AS 
    l_id_direccion NUMBER;
BEGIN
    INSERT INTO DIRECCIONES(DIRECCION, ID_MUNICIPIO_DIRECCION) VALUES(DIRECCION, ID_MUNICIPIO)
    RETURNING ID_DIRECCION INTO l_id_direccion;
    RETURN l_id_direccion;
END INSERTDIRECCION;
------------------------------

create or replace PROCEDURE SP_INSERT_USER_ADMI 
(
  USER_NAME IN VARCHAR2 
, PASSWORD_USER IN VARCHAR2 
, EMAIL_ADDRESS IN VARCHAR2 
, ID_STATUS IN NUMBER
, ID_ROLE IN NUMBER
, DIRECCION IN VARCHAR2
, ID_STATE IN NUMBER
, FIRST_NAME IN VARCHAR2
, SECOND_NAME IN VARCHAR2
, LAST_NAME IN VARCHAR2
, SECOND_LASTNAME IN VARCHAR2
, AGE IN NUMBER
, GENDER IN CHAR
, CELL_PHONE IN NUMBER
) 
AS 
    l_id_address number;
    l_id_person number;
BEGIN
  l_id_address := INSERTDIRECCION(DIRECCION, ID_STATE);
  l_id_person := INSERTPERSONA(FIRST_NAME, SECOND_NAME, LAST_NAME, SECOND_LASTNAME, AGE, GENDER, CELL_PHONE, l_id_address);
  INSERT INTO USUARIOS (NOMBRE_USUARIO, CLAVE_USUARIO, EMAIL, IMAGE_PERFIL, ID_ESTADO_USUARIO, ID_PERSONA_USUARIO, ID_ROL_USUARIO, ULTIMA_MODIFICACION)
  VALUES(USER_NAME,PASSWORD_USER,EMAIL_ADDRESS,NULL,ID_STATUS,l_id_person,ID_ROLE,NULL);
END SP_INSERT_USER_ADMI;
