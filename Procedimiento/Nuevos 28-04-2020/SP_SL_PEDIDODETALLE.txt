create or replace procedure SP_SL_PEDIDODETALLE(CODIGO IN INT)
AS 
id_cursor SYS_REFCURSOR;
 OPTION_NOT_FOUND EXCEPTION;
begin 
  savepoint prev;

OPEN id_cursor FOR

SELECT
 P.CANTIDAD as Cantidad,
BASE64ENCODE(A.IMAGEN_ARTICULO) AS Imagen,
A.NOMBRE_ARTICULO as Nombre,
P.PRECIO as Precio,
P.TOTAL_ARTICULO as Total
from DETALLE_PEDIDO P 
inner join  ARTICULOS A ON A.ID_ARTICULO=P.ID_ARTICULO_DETALLE 
WHERE P.ID_PEDIDO_DETALLE=CODIGO;

 APEX_JSON.write(id_cursor);
    COMMIT;
EXCEPTION 
    WHEN OPTION_NOT_FOUND THEN
         HTP.print(SQLERRM);
    WHEN OTHERS THEN
         HTP.print(SQLERRM);
end SP_SL_PEDIDODETALLE;